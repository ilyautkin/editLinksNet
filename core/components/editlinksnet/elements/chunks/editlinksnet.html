<div id="popUpBox" style="position:absolute; display:none;
background:#fff; cursor: pointer; border:3px solid #ccc;
color: #333; font: bold 14px arial; padding:5px 15px;">
<form action="[[~[[*id]]]]?act=editLink" method="post" class="form">
    <input type="text" name="url" id="url"
     value="[[++site_url]][[*parent:eq=`0`:then=``:else=`[[~[[*parent]]]]`]]">
    <textarea style="display: none;" name="outer" id="outer"></textarea>
    <input type="hidden" name="id" value="[[*id]]">
    <input type="submit" name="submit" value="OK" style="width: 40px; height: 28px;"
     class="btn primary">
</form>
</div>
<div style="position:fixed;z-index:1000;right:5px;top:5px;" id="editLinksNet">
    <a href="[[~[[*id]]]]?act=cancel" style="display: block; color: #fff;
     text-decoration: none; padding: 5px 4px; background: #779937;
     border-radius: 3px; border: 1px solid #5C7F17;
     margin: 3px auto 5px;">Отмена последней ссылки</a>
</div>
<script type="text/javascript" src="/assets/components/editlinksnet/js/selection.js"></script>
<script type="text/javascript">
jQuery(function($) {
    var $txt = "";
    $("#content").bind("mouseup", function(e){
            
            var txt = $.selection().get().text // вернет выделенный text
            if (txt!=""){
            $('abbr').replaceWith($('abbr').html());
            // Заменяем выделенный текст на ссылку
            $.selection().set('<abbr style="color: #00c; text-decoration: underline;">'
              + txt + '</abbr>'); 
            $("#popUpBox").css({"display":"block", "left":e.pageX-60+"px",
              "top":e.pageY+15+"px"});
            $("#url").focus();
            $("#url").select();
            $("#outer").html($('#content').html());
            } else {
            $("#popUpBox").css({"display":"none"});
            $('abbr').replaceWith($('abbr').html());
            }
    });
});
</script>